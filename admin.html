<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golden Balance | Admin Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        :root {
            --gold-bright: #D4AF37; /* Svetla zlatna */
            --gold-medium: #C5A028; /* Srednja zlatna */
            --gold-dark: #A8861D; /* Tamna zlatna */
            --gold-pale: #E6C870; /* Bleda zlatna */
            --gradient-gold: linear-gradient(135deg, #D4AF37, #C5A028, #A8861D); /* Zlatni gradijent */
            --gradient-gold-light: linear-gradient(135deg, #E6C870, #D4AF37); /* Svetli zlatni gradijent */
            --gradient-gold-dark: linear-gradient(135deg, #A8861D, #856614); /* Tamni zlatni gradijent */
            --dark-bg: #0E0E10; /* Tamna pozadina */
            --dark-card: #16161A; /* Tamna kartica */
            --dark-accent: #222224; /* Tamni akcentni element */
            --light-text: #F8F8FF; /* Svetli tekst */
            --muted-text: #BBBBBB; /* Prigušeni tekst */
            --border-light: rgba(212, 175, 55, 0.2);
            --glass-effect: rgba(212, 175, 55, 0.03);
            --box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
            --border-radius: 1rem;
            --border-radius-lg: 1.5rem;
            --spacing-xs: 0.5rem;
            --spacing-sm: 0.75rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
        }

        /* Modern Background Effect */
        body {
            background: var(--dark-bg);
            position: relative;
            min-height: 100vh;
            color: var(--light-text);
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }

        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            right: -50%;
            bottom: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, transparent 30%, var(--dark-bg) 70%), 
                        radial-gradient(circle at top left, var(--gold-bright), transparent 40%),
                        radial-gradient(circle at bottom right, var(--gold-dark), transparent 40%),
                        radial-gradient(circle at top right, var(--gold-medium), transparent 40%);
            background-size: 100% 100%, 50% 50%, 50% 50%, 50% 50%;
            background-position: center, top left, bottom right, top right;
            filter: blur(60px);
            opacity: 0.1;
            z-index: -2;
            transform: rotate(0deg);
            animation: backgroundAnimation 30s infinite alternate ease-in-out;
        }
        
        @keyframes backgroundAnimation {
            0% {
                transform: rotate(0deg) scale(1);
            }
            100% {
                transform: rotate(5deg) scale(1.1);
            }
        }

        .container {
            background: rgba(16, 16, 18, 0.3);
            border-radius: var(--border-radius-lg);
            margin: 2rem auto;
            padding: 2.5rem;
            width: 90%;
            max-width: 800px;
            box-shadow: var(--box-shadow);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-light);
            backdrop-filter: blur(10px);
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.03), transparent);
            pointer-events: none;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2.5rem;
            background: rgba(16, 16, 18, 0.7);
            backdrop-filter: blur(16px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            margin: 0 1rem 1rem 1rem;
            border: 1px solid var(--border-light);
        }

        .header .brand {
            font-size: 1.6rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 1.2rem;
            cursor: pointer;
        }

        .header .brand span {
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h1, h2, h3 {
            color: var(--gold-bright);
            margin-bottom: var(--spacing-md);
        }

        .login-form, .admin-panel {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        label {
            font-weight: 500;
            color: var(--gold-pale);
        }

        input, select, textarea {
            width: 100%;
            padding: 0.9rem 1.2rem;
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius);
            background: rgba(31, 41, 55, 0.4);
            color: var(--light-text);
            margin-bottom: 0.5rem;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(5px);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--gold-bright);
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.25);
            background: rgba(31, 41, 55, 0.6);
        }

        button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            background: var(--gradient-gold);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--box-shadow);
            position: relative;
            overflow: hidden;
            z-index: 1;
            letter-spacing: 0.5px;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.1);
        }

        button:active {
            transform: translateY(0);
        }

        .logo-preview {
            width: 100%;
            padding: 1rem;
            border: 1px dashed var(--gold-medium);
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            min-height: 150px; /* Minimalna visina da se izbegne skakanje interfejsa */
        }

        .logo-preview img {
            max-width: 200px;
            max-height: 200px;
            object-fit: contain;
            background-color: rgba(255, 255, 255, 0.1); /* Blaga pozadina za bolje prikazivanje transparentnih slika */
            border-radius: var(--border-radius);
            padding: 5px; /* Malo prostora oko slike */
        }

        .success-message {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid #10b981;
            color: #10b981;
            padding: 1rem;
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-md);
            display: none;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid #ef4444;
            color: #ef4444;
            padding: 1rem;
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-md);
            display: none;
        }

        .nav-link {
            padding: 0.5rem 1rem;
            color: var(--gold-pale);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: rgba(212, 175, 55, 0.1);
            color: var(--gold-bright);
        }        #loginSection, #adminSection {
            transition: all 0.3s ease;
        }

        #adminSection {
            display: none;
        }
        
        /* Stilovi za tabele */
        .table-responsive {
            overflow-x: auto;
            margin-top: 1rem;
        }
        
        .inquiries-table, .consultations-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(22, 22, 26, 0.7);
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .inquiries-table th, .inquiries-table td,
        .consultations-table th, .consultations-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }
        
        .inquiries-table th, .consultations-table th {
            background: var(--dark-accent);
            color: var(--gold-bright);
            font-weight: 600;
        }
        
        .inquiries-table tr:hover, .consultations-table tr:hover {
            background: rgba(212, 175, 55, 0.1);
        }
        
        .status-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            color: white;
        }
        
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .action-btn {
            padding: 0.25rem 0.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }
        
        .action-btn.confirm-btn {
            background: #10b981;
            color: white;
        }
        
        .action-btn.cancel-btn {
            background: #ef4444;
            color: white;
        }
        
        .action-btn.complete-btn {
            background: #a855f7;
            color: white;
        }
        
        .action-btn.delete-btn {
            background: #6b7280;
            color: white;
        }
        
        .action-btn:hover {
            transform: translateY(-1px);
            opacity: 0.9;
        }
        
        .email-link {
            color: var(--gold-bright);
            text-decoration: none;
        }
        
        .email-link:hover {
            text-decoration: underline;
        }
        
        .empty-state {
            text-align: center;
            padding: 2rem;
            color: var(--muted-text);
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: var(--gradient-gold);
            color: white;
        }
        
        .btn-secondary {
            background: var(--dark-accent);
            color: var(--gold-pale);
            border: 1px solid var(--border-light);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .form-control {
            background: rgba(31, 41, 55, 0.4);
            border: 1px solid var(--border-light);
            color: var(--light-text);
            border-radius: var(--border-radius);
            padding: 0.5rem;
        }
        
        .mb-3 {
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="brand" onclick="window.location.href='preview.html'">
            <span>Golden Balance</span>
            <span style="font-size: 1rem; font-weight: normal; color: var(--gold-pale);">| Admin Panel</span>
        </div>
        <div>
            <a href="preview.html" class="nav-link">
                <i class="fas fa-home"></i> Početna
            </a>
        </div>
    </header>

    <div class="container">
        <!-- Login Section -->
        <div id="loginSection">
            <h1>Admin Prijava</h1>
            <p>Unesite svoje pristupne podatke za pristup admin panelu.</p>
            
            <div class="error-message" id="loginError">
                Netačan email ili lozinka. Pokušajte ponovo.
            </div>
            
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="Unesite vaš email" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Lozinka</label>
                    <input type="password" id="password" placeholder="Unesite vašu lozinku" required>
                </div>
                
                <button type="submit">Prijavi se</button>
            </form>
        </div>
        
        <!-- Admin Panel Section -->
        <div id="adminSection">
            <div class="admin-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                <h1>Admin Panel</h1>
                <button id="logoutBtn" style="background: var(--dark-accent); color: var(--gold-pale); border: 1px solid var(--gold-dark);">
                    <i class="fas fa-sign-out-alt"></i> Odjava
                </button>
            </div>
            
            <div class="success-message" id="saveSuccess">
                Logo je uspešno sačuvan i biće prikazan na svim stranicama.
            </div>
              <!-- Admin Navigation Tabs -->
            <div class="admin-tabs" style="display: flex; margin-bottom: var(--spacing-lg); border-bottom: 1px solid var(--border-light); padding-bottom: 1rem;">
                <button id="logoTabBtn" class="tab-button active" style="margin-right: 1rem; background: transparent; color: var(--gold-bright); border: none; font-weight: 600; padding: 0.5rem 1rem; cursor: pointer; border-bottom: 2px solid var(--gold-bright);">
                    <i class="fas fa-image"></i> Upravljanje Logotipom
                </button>
                <button id="dataTabBtn" class="tab-button" style="margin-right: 1rem; background: transparent; color: var(--muted-text); border: none; font-weight: 600; padding: 0.5rem 1rem; cursor: pointer;">
                    <i class="fas fa-database"></i> Pregled Podataka
                </button>
                <button id="inquiriesTabBtn" class="tab-button" style="margin-right: 1rem; background: transparent; color: var(--muted-text); border: none; font-weight: 600; padding: 0.5rem 1rem; cursor: pointer;">
                    <i class="fas fa-envelope"></i> Upiti korisnika
                </button>
                <button id="consultationsTabBtn" class="tab-button" style="margin-right: 1rem; background: transparent; color: var(--muted-text); border: none; font-weight: 600; padding: 0.5rem 1rem; cursor: pointer;">
                    <i class="fas fa-calendar-check"></i> Konsultacije
                </button>
            </div>
            
            <!-- Logo Management Tab -->
            <div id="logoTab" class="admin-tab-content" style="display: block;">
                <h2>Upravljanje Logotipom</h2>
                <p>Ovde možete postaviti ili promeniti logo koji će biti prikazan na svim stranicama aplikacije.</p>
            
                <div class="logo-preview" style="background: rgba(30, 30, 40, 0.4); min-height: 150px; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                    <h3>Trenutni Logo</h3>
                    <img id="currentLogo" src="https://i.imgur.com/yQGiMd5.png" alt="Trenutni logo" style="max-width: 180px; max-height: 180px; background-color: rgba(255, 255, 255, 0.05); padding: 5px; border-radius: 4px; background-image: linear-gradient(45deg, rgba(200, 200, 200, 0.2) 25%, transparent 25%), linear-gradient(-45deg, rgba(200, 200, 200, 0.2) 25%, transparent 25%), linear-gradient(45deg, transparent 75%, rgba(200, 200, 200, 0.2) 75%), linear-gradient(-45deg, transparent 75%, rgba(200, 200, 200, 0.2) 75%); background-size: 20px 20px; background-position: 0 0, 0 10px, 10px -10px, -10px 0px;">
                </div>
                
                <form class="admin-panel" id="logoForm">
                    <div class="form-group">
                        <label for="logoUrl">URL adresa loga</label>
                        <input type="url" id="logoUrl" placeholder="Unesite URL adresu loga (npr. https://example.com/logo.png)">
                        <small style="color: var(--muted-text);">* Podržane su slike sa društvenih mreža (Facebook, Instagram, Imgur, itd.), direktni linkovi do slika (JPG, PNG, GIF) i bilo koji URL koji sadrži sliku.</small>
                    </div>

                    <div class="form-group">
                        <label for="logoUpload">Ili učitajte logo sa računara</label>
                        <input type="file" id="logoUpload" accept="image/*">
                        <small style="color: var(--muted-text);">* Maksimalna veličina: 2MB. Preporučene dimenzije: 200x200 piksela.</small>
                    </div>
                    
                <div class="form-group">
                        <label>Pregled novog loga</label>
                        <div class="logo-preview" style="background: rgba(30, 30, 40, 0.4); min-height: 120px; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                            <img id="logoPreview" src="" alt="Preview novog loga" style="display: none; max-width: 180px; max-height: 180px; background-color: rgba(255, 255, 255, 0.05); padding: 5px; border-radius: 4px; background-image: linear-gradient(45deg, rgba(200, 200, 200, 0.2) 25%, transparent 25%), linear-gradient(-45deg, rgba(200, 200, 200, 0.2) 25%, transparent 25%), linear-gradient(45deg, transparent 75%, rgba(200, 200, 200, 0.2) 75%), linear-gradient(-45deg, transparent 75%, rgba(200, 200, 200, 0.2) 75%); background-size: 20px 20px; background-position: 0 0, 0 10px, 10px -10px, -10px 0px;">
                            <p id="noPreview" style="color: var(--muted-text);">Ovde će biti prikazan pregled novog loga.</p>
                        </div>
                    </div>
                    
                    <button type="submit" id="saveLogo">Sačuvaj Logo</button>
                </form>
            </div>
            
            <!-- Database View Tab -->
            <div id="dataTab" class="admin-tab-content" style="display: none;">
                <h2>Pregled Podataka</h2>
                <p>Ovde možete pregledati sve podatke koji su sačuvani u LocalStorage bazi podataka aplikacije.</p>
                
                <div class="form-group">
                    <button id="refreshDataBtn" style="margin-bottom: var(--spacing-md);">
                        <i class="fas fa-sync-alt"></i> Osveži Podatke
                    </button>
                </div>
                
                <div class="data-container">
                    <div id="data-entries" style="margin-bottom: var(--spacing-lg);">
                        <!-- Ovde će biti prikazani podaci -->
                    </div>
                </div>
            </div>
              <!-- Inquiries Tab -->
            <div id="inquiriesTab" class="admin-tab-content" style="display: none;">
                <h2>Upiti korisnika</h2>
                <div class="inquiries-actions mb-3">
                    <button id="refreshInquiriesBtn" class="btn btn-secondary">
                        <i class="fas fa-sync-alt"></i> Osveži listu
                    </button>
                    <div class="inquiries-filter">
                        <select id="inquiriesFilter" class="form-control">
                            <option value="all">Svi upiti</option>
                            <option value="new">Novi</option>
                            <option value="in_progress">U obradi</option>
                            <option value="resolved">Rešeni</option>
                        </select>
                    </div>
                </div>
                <div class="inquiries-list">
                    <div class="table-responsive">
                        <table class="inquiries-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Datum</th>
                                    <th>Pitanje</th>
                                    <th>Email</th>
                                    <th>Telefon</th>
                                    <th>Status</th>
                                    <th>Akcije</th>
                                </tr>
                            </thead>
                            <tbody id="inquiriesList">
                                <!-- Upiti će biti učitani ovde -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Consultations Tab -->
            <div id="consultationsTab" class="admin-tab-content" style="display: none;">
                <div class="consultations-header mb-3">
                    <h2 style="color: var(--gold-bright); margin-bottom: 1rem;">
                        <i class="fas fa-calendar-check"></i> Upravljanje Konsultacijama
                    </h2>
                    <div class="consultations-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                        <div class="stat-card" style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 8px; padding: 1rem; text-align: center;">
                            <div class="stat-number" style="font-size: 2rem; font-weight: bold; color: #10b981;" id="pendingCount">0</div>
                            <div class="stat-label" style="color: var(--muted-text);">Na čekanju</div>
                        </div>
                        <div class="stat-card" style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 8px; padding: 1rem; text-align: center;">
                            <div class="stat-number" style="font-size: 2rem; font-weight: bold; color: #3b82f6;" id="confirmedCount">0</div>
                            <div class="stat-label" style="color: var(--muted-text);">Potvrđeno</div>
                        </div>
                        <div class="stat-card" style="background: rgba(168, 85, 247, 0.1); border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 8px; padding: 1rem; text-align: center;">
                            <div class="stat-number" style="font-size: 2rem; font-weight: bold; color: #a855f7;" id="completedCount">0</div>
                            <div class="stat-label" style="color: var(--muted-text);">Završeno</div>
                        </div>
                        <div class="stat-card" style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 1rem; text-align: center;">
                            <div class="stat-number" style="font-size: 2rem; font-weight: bold; color: #ef4444;" id="canceledCount">0</div>
                            <div class="stat-label" style="color: var(--muted-text);">Otkazano</div>
                        </div>
                    </div>
                </div>
                
                <div class="consultations-actions mb-3" style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                    <button id="refreshConsultationsBtn" class="btn btn-secondary">
                        <i class="fas fa-sync-alt"></i> Osveži listu
                    </button>
                    <div class="consultations-filter">
                        <select id="consultationsFilter" class="form-control" style="min-width: 150px;">
                            <option value="all">Sve konsultacije</option>
                            <option value="pending">Na čekanju</option>
                            <option value="confirmed">Potvrđeno</option>
                            <option value="completed">Završeno</option>
                            <option value="canceled">Otkazano</option>
                        </select>
                    </div>
                    <div class="export-actions">
                        <button id="exportConsultationsBtn" class="btn btn-primary">
                            <i class="fas fa-download"></i> Izvezi CSV
                        </button>
                    </div>
                </div>
                
                <div class="consultations-list">
                    <div class="table-responsive">
                        <div id="consultationsTable">
                            <!-- Konsultacije će biti učitane ovde -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Admin kredencijali
        const ADMIN_EMAIL = 'zorandostica2@gmail.com';
        const ADMIN_PASSWORD = 'zoran2403'; // Admin lozinka
        
        // DOM elementi
        const loginSection = document.getElementById('loginSection');
        const adminSection = document.getElementById('adminSection');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const logoForm = document.getElementById('logoForm');
        const logoUrl = document.getElementById('logoUrl');
        const logoUpload = document.getElementById('logoUpload');
        const logoPreview = document.getElementById('logoPreview');
        const noPreview = document.getElementById('noPreview');
        const currentLogo = document.getElementById('currentLogo');
        const saveSuccess = document.getElementById('saveSuccess');
        const logoutBtn = document.getElementById('logoutBtn');
        
        // Provera da li je korisnik već prijavljen
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('admin_logged_in');
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            
            // Provera da li je korisnik prijavljen i da li je admin
            if (isLoggedIn === 'true' && currentUser.email === ADMIN_EMAIL) {
                loginSection.style.display = 'none';
                adminSection.style.display = 'block';
            } else {
                // Prikaži login formu
                loginSection.style.display = 'block';
                adminSection.style.display = 'none';
            }
        }
        
        // Inicijalno učitavanje sačuvanog loga ako postoji
        function loadSavedLogo() {
            const savedLogo = localStorage.getItem('site_logo');
            if (savedLogo) {
                currentLogo.src = savedLogo;
            }
        }
        
        // Prijava admina - koristi hardkodiranu lozinku za lakši pristup
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Jednostavna provera sa hardkodiranim kredencijalima
            if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
                // Store user data in localStorage na isti način kao u preview.html
                localStorage.setItem('currentUser', JSON.stringify({
                    email: email,
                    name: 'Administrator',
                    isAdmin: true
                }));
                localStorage.setItem('admin_logged_in', 'true');
                
                loginSection.style.display = 'none';
                adminSection.style.display = 'block';
                loginError.style.display = 'none';
            } else {
                loginError.style.display = 'block';
                loginError.textContent = 'Netačan email ili lozinka. Koristite: zorandostica2@gmail.com / zoran2403';
            }
        });
        
        // Odjava admina
        logoutBtn.addEventListener('click', function() {
            localStorage.removeItem('admin_logged_in');
            localStorage.removeItem('currentUser');
            loginSection.style.display = 'block';
            adminSection.style.display = 'none';
            window.location.href = 'preview.html';
        });
        
        // Pregled loga iz URL-a
        logoUrl.addEventListener('input', function() {
            const url = this.value.trim();
            if (url) {
                // Prikazujemo indikator učitavanja
                noPreview.textContent = 'Učitavanje...';
                noPreview.style.display = 'block';
                logoPreview.style.display = 'none';
                
                // Transformišemo URL ako je potrebno (npr. Google Drive, Instagram...)
                let processedUrl = url;
                
                // Google Drive transformacija
                if (url.includes('drive.google.com') && url.includes('/file/d/')) {
                    const fileId = url.match(/\/file\/d\/([^\/]+)/);
                    if (fileId && fileId[1]) {
                        processedUrl = `https://drive.google.com/uc?export=view&id=${fileId[1]}`;
                        console.log('Google Drive URL transformisan:', processedUrl);
                    }
                }
                
                // Proveravamo da li je URL validan za sliku
                if (isValidImageUrl(url)) {
                    // Testiramo učitavanje slike
                    const testImg = new Image();
                    testImg.onload = function() {
                        // Slika je uspešno učitana
                        logoPreview.src = processedUrl;
                        logoPreview.style.display = 'block';
                        noPreview.style.display = 'none';
                    };
                    testImg.onerror = function() {
                        // Greška pri učitavanju slike
                        logoPreview.style.display = 'none';
                        noPreview.innerHTML = `
                            <div style="color: #ef4444;">
                                Nemoguće učitati sliku sa unetog URL-a.<br>
                                <small>
                                    Mogući razlozi:<br>
                                    - URL ne vodi direktno do slike<br>
                                    - Sajt ne dozvoljava preuzimanje slika (CORS ograničenja)<br>
                                    - Koristite link sa društvene mreže koji zahteva pristup<br>
                                    <br>
                                    Probajte direktan link do slike ili opciju za upload fajla.
                                </small>
                            </div>
                        `;
                        noPreview.style.display = 'block';
                        console.error('Greška pri učitavanju slike sa URL-a:', url);
                    };
                    testImg.src = processedUrl;
                } else {
                    // URL ne izgleda kao slika
                    logoPreview.style.display = 'none';
                    noPreview.innerHTML = `
                        <div style="color: #ef4444;">
                            URL ne izgleda kao validan link do slike.<br>
                            <small>
                                Probajte sa:<br>
                                - Direktnim linkom do slike (završava se sa .jpg, .png, itd.)<br>
                                - URL-om iz adresne trake kada gledate samo sliku u browseru<br>
                                - Korišćenjem "Kopiraj adresu slike" opcije na društvenim mrežama<br>
                            </small>
                        </div>
                    `;
                    noPreview.style.display = 'block';
                }
            } else {
                // Prazan URL
                logoPreview.style.display = 'none';
                noPreview.textContent = 'Ovde će biti prikazan pregled novog loga.';
                noPreview.style.display = 'block';
            }
        });
        
        // Pregled učitanog loga
        logoUpload.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                // Provera veličine fajla (manje od 2MB)
                if (file.size > 2 * 1024 * 1024) {
                    alert('Slika je prevelika. Maksimalna veličina je 2MB.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(e) {
                    // Compress image if needed using a canvas element
                    const img = new Image();
                    img.onload = function() {
                        // Check if image needs resizing
                        let width = img.width;
                        let height = img.height;
                        
                        // If image is too large, resize it while keeping aspect ratio
                        const maxDimension = 200;
                        if (width > maxDimension || height > maxDimension) {
                            if (width > height) {
                                height = Math.round(height * (maxDimension / width));
                                width = maxDimension;
                            } else {
                                width = Math.round(width * (maxDimension / height));
                                height = maxDimension;
                            }
                        }
                        
                        // Create canvas and resize image
                        const canvas = document.createElement('canvas');
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // Convert to format that works well in browsers
                        logoPreview.src = canvas.toDataURL('image/png', 0.9);
                        logoPreview.style.display = 'block';
                        noPreview.style.display = 'none';
                        
                        // Praznimo URL polje jer koristimo učitanu sliku
                        logoUrl.value = '';
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });
          // Tab kontrola
        const logoTabBtn = document.getElementById('logoTabBtn');
        const dataTabBtn = document.getElementById('dataTabBtn');
        const inquiriesTabBtn = document.getElementById('inquiriesTabBtn');
        const consultationsTabBtn = document.getElementById('consultationsTabBtn');
        const logoTab = document.getElementById('logoTab');
        const dataTab = document.getElementById('dataTab');
        const inquiriesTab = document.getElementById('inquiriesTab');
        const consultationsTab = document.getElementById('consultationsTab');
        const refreshDataBtn = document.getElementById('refreshDataBtn');
        const dataEntries = document.getElementById('data-entries');
        const refreshInquiriesBtn = document.getElementById('refreshInquiriesBtn');
        const inquiriesList = document.getElementById('inquiriesList');
          // Prebacivanje između tabova
        logoTabBtn.addEventListener('click', function() {
            logoTab.style.display = 'block';
            dataTab.style.display = 'none';
            inquiriesTab.style.display = 'none';
            consultationsTab.style.display = 'none';
            
            logoTabBtn.classList.add('active');
            logoTabBtn.style.color = 'var(--gold-bright)';
            logoTabBtn.style.borderBottom = '2px solid var(--gold-bright)';
            
            dataTabBtn.classList.remove('active');
            dataTabBtn.style.color = 'var(--muted-text)';
            dataTabBtn.style.borderBottom = 'none';
            
            inquiriesTabBtn.classList.remove('active');
            inquiriesTabBtn.style.color = 'var(--muted-text)';
            inquiriesTabBtn.style.borderBottom = 'none';
            
            consultationsTabBtn.classList.remove('active');
            consultationsTabBtn.style.color = 'var(--muted-text)';
            consultationsTabBtn.style.borderBottom = 'none';
        });
          dataTabBtn.addEventListener('click', function() {
            dataTab.style.display = 'block';
            logoTab.style.display = 'none';
            inquiriesTab.style.display = 'none';
            consultationsTab.style.display = 'none';
            
            dataTabBtn.classList.add('active');
            dataTabBtn.style.color = 'var(--gold-bright)';
            dataTabBtn.style.borderBottom = '2px solid var(--gold-bright)';
            
            logoTabBtn.classList.remove('active');
            logoTabBtn.style.color = 'var(--muted-text)';
            logoTabBtn.style.borderBottom = 'none';
            
            inquiriesTabBtn.classList.remove('active');
            inquiriesTabBtn.style.color = 'var(--muted-text)';
            inquiriesTabBtn.style.borderBottom = 'none';
            
            consultationsTabBtn.classList.remove('active');
            consultationsTabBtn.style.color = 'var(--muted-text)';
            consultationsTabBtn.style.borderBottom = 'none';
            
            // Prikaz podataka prilikom prebacivanja na tab
            loadLocalStorageData();
        });
          inquiriesTabBtn.addEventListener('click', function() {
            inquiriesTab.style.display = 'block';
            logoTab.style.display = 'none';
            dataTab.style.display = 'none';
            consultationsTab.style.display = 'none';
            
            inquiriesTabBtn.classList.add('active');
            inquiriesTabBtn.style.color = 'var(--gold-bright)';
            inquiriesTabBtn.style.borderBottom = '2px solid var(--gold-bright)';
            
            logoTabBtn.classList.remove('active');
            logoTabBtn.style.color = 'var(--muted-text)';
            logoTabBtn.style.borderBottom = 'none';
            
            dataTabBtn.classList.remove('active');
            dataTabBtn.style.color = 'var(--muted-text)';
            dataTabBtn.style.borderBottom = 'none';
            
            consultationsTabBtn.classList.remove('active');
            consultationsTabBtn.style.color = 'var(--muted-text)';
            consultationsTabBtn.style.borderBottom = 'none';
            
            // Prikaz upita prilikom prebacivanja na tab
            loadInquiries();
        });
        
        consultationsTabBtn.addEventListener('click', function() {
            consultationsTab.style.display = 'block';
            logoTab.style.display = 'none';
            dataTab.style.display = 'none';
            inquiriesTab.style.display = 'none';
            
            consultationsTabBtn.classList.add('active');
            consultationsTabBtn.style.color = 'var(--gold-bright)';
            consultationsTabBtn.style.borderBottom = '2px solid var(--gold-bright)';
            
            logoTabBtn.classList.remove('active');
            logoTabBtn.style.color = 'var(--muted-text)';
            logoTabBtn.style.borderBottom = 'none';
            
            dataTabBtn.classList.remove('active');
            dataTabBtn.style.color = 'var(--muted-text)';
            dataTabBtn.style.borderBottom = 'none';
            
            inquiriesTabBtn.classList.remove('active');
            inquiriesTabBtn.style.color = 'var(--muted-text)';
            inquiriesTabBtn.style.borderBottom = 'none';
              // Prikaz konsultacija i ažuriranje statistika prilikom prebacivanja na tab
            loadConsultations();
            updateConsultationStats();
        });
        
        // Funkcija za učitavanje i formatiranje podataka iz localStorage
        function loadLocalStorageData() {
            dataEntries.innerHTML = '';
            
            if (localStorage.length === 0) {
                dataEntries.innerHTML = `
                    <div style="padding: 1rem; background: var(--dark-accent); border-radius: var(--border-radius); margin-bottom: 1rem;">
                        <p style="color: var(--muted-text);">Nema podataka u bazi.</p>
                    </div>
                `;
                return;
            }
            
            // Kreiranje HTML tabele za prikaz podataka
            let html = `
                <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 2rem;">
                    <thead>
                        <tr style="background: var(--dark-accent); color: var(--gold-bright);">
                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid var(--border-light);">Ključ</th>
                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid var(--border-light);">Vrednost</th>
                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid var(--border-light);">Akcije</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Prolazak kroz sve stavke u localStorage
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                let value = localStorage.getItem(key);
                
                try {
                    // Pokušaj parsiranja JSON vrednosti za lepši prikaz
                    const parsedValue = JSON.parse(value);
                    value = JSON.stringify(parsedValue, null, 2);
                } catch (e) {
                    // Nije JSON, ostavi kao string
                }
                
                // Skraćivanje prikaza dugih vrednosti
                const displayValue = value.length > 100 ? value.substring(0, 100) + '...' : value;
                
                // Posebno formatiranje za slike
                let valueDisplay = displayValue;
                if (key === 'site_logo' || value.startsWith('data:image') || value.startsWith('http') || value.includes('/')) {
                    valueDisplay = `<img src="${value}" style="max-height: 50px; max-width: 100px;" />\n(Slika)`;
                }
                
                html += `
                    <tr style="border-bottom: 1px solid var(--border-light);">
                        <td style="padding: 1rem; vertical-align: top;">${key}</td>
                        <td style="padding: 1rem; vertical-align: top; font-family: monospace; font-size: 0.9rem; white-space: pre-wrap;">${valueDisplay}</td>
                        <td style="padding: 1rem; vertical-align: top;">
                            <button class="view-data-btn" data-key="${key}" style="background: transparent; color: var(--gold-pale); border: 1px solid var(--gold-dark); padding: 0.3rem 0.6rem; margin-right: 0.5rem; font-size: 0.8rem;">
                                <i class="fas fa-eye"></i> Pregledaj
                            </button>
                            <button class="delete-data-btn" data-key="${key}" style="background: transparent; color: #ef4444; border: 1px solid #ef4444; padding: 0.3rem 0.6rem; font-size: 0.8rem;">
                                <i class="fas fa-trash-alt"></i> Izbriši
                            </button>
                        </td>
                    </tr>
                `;
            }
            
            html += `
                    </tbody>
                </table>
                </div>
            `;
            
            dataEntries.innerHTML = html;
            
            // Dodavanje event listenera za dugmad
            document.querySelectorAll('.view-data-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const key = this.getAttribute('data-key');
                    const value = localStorage.getItem(key);
                    
                    let formattedValue = value;
                    try {
                        const parsedValue = JSON.parse(value);
                        formattedValue = JSON.stringify(parsedValue, null, 2);
                    } catch (e) {}
                    
                    // Prikaz modalnog prozora sa detaljima
                    alert(`Ključ: ${key}\n\nVrednost:\n${formattedValue}`);
                });
            });
            
            document.querySelectorAll('.delete-data-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const key = this.getAttribute('data-key');
                    if (confirm(`Da li ste sigurni da želite obrisati podatke sa ključem "${key}"?`)) {
                        localStorage.removeItem(key);
                        loadLocalStorageData(); // Ponovno učitavanje podataka
                    }
                });
            });
        }
        
        // Dugme za osvežavanje podataka
        refreshDataBtn.addEventListener('click', loadLocalStorageData);
        
        // Čuvanje loga
        logoForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            let logoSource = '';
            
            // Prioritet ima učitana slika, zatim URL
            if (logoPreview.style.display === 'block') {
                logoSource = logoPreview.src;
                
                try {
                    // Posebno rukovanje za URL-ove sa društvenih mreža
                    // Direktno čuvamo URL za eksterne slike (ne Base64)
                    if (logoSource.startsWith('http') && !logoSource.startsWith('data:')) {
                        // Sačuvaj URL direktno
                        localStorage.setItem('site_logo', logoSource);
                        
                        // Ažuriranje prikaza trenutnog loga
                        currentLogo.src = logoSource;
                        
                        // Prikazivanje poruke o uspešnom čuvanju
                        saveSuccess.style.display = 'block';
                        setTimeout(() => {
                            saveSuccess.style.display = 'none';
                        }, 3000);
                        
                        // Praznimo polja forme
                        logoUrl.value = '';
                        logoUpload.value = '';
                        logoPreview.style.display = 'none';
                        noPreview.style.display = 'block';
                        noPreview.textContent = 'Ovde će biti prikazan pregled novog loga.';
                        return;
                    }
                
                    // Dodatna provera za Base64 URL-ove - provera ako je prevelika
                    if (logoSource.startsWith('data:image')) {
                        // Provera veličine Base64 stringa (less than ~1.5MB compressed)
                        if (logoSource.length > 2000000) {
                            // Kompresuj sliku dodatno
                            const img = new Image();
                            img.onload = function() {
                                const canvas = document.createElement('canvas');
                                const ctx = canvas.getContext('2d');
                                
                                // Smanjiti dimenzije ako je potrebno
                                let width = img.width;
                                let height = img.height;
                                const maxDimension = 150; // Smanjujemo još više ako je potrebno
                                
                                if (width > maxDimension || height > maxDimension) {
                                    if (width > height) {
                                        height = Math.round(height * (maxDimension / width));
                                        width = maxDimension;
                                    } else {
                                        width = Math.round(width * (maxDimension / height));
                                        height = maxDimension;
                                    }
                                }
                                
                                canvas.width = width;
                                canvas.height = height;
                                ctx.drawImage(img, 0, 0, width, height);
                                
                                // Kompresuj sa nižim kvalitetom
                                const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.7);
                                
                                // Sačuvaj kompresovanu verziju
                                localStorage.setItem('site_logo', compressedDataUrl);
                                currentLogo.src = compressedDataUrl;
                                
                                // Prikazivanje poruke o uspešnom čuvanju
                                saveSuccess.style.display = 'block';
                                setTimeout(() => {
                                    saveSuccess.style.display = 'none';
                                }, 3000);
                                
                                // Praznimo polja forme
                                logoUrl.value = '';
                                logoUpload.value = '';
                                logoPreview.style.display = 'none';
                                noPreview.style.display = 'block';
                            };
                            img.src = logoSource;
                            return; // Return early to prevent normal flow
                        }
                    }
                    
                    // Standardno čuvanje ako nije Base64 ili nije prevelika
                    localStorage.setItem('site_logo', logoSource);
                    
                    // Ažuriranje prikaza trenutnog loga
                    currentLogo.src = logoSource;
                    
                    // Prikazivanje poruke o uspešnom čuvanju
                    saveSuccess.style.display = 'block';
                    setTimeout(() => {
                        saveSuccess.style.display = 'none';
                    }, 3000);
                    
                    // Praznimo polja forme
                    logoUrl.value = '';
                    logoUpload.value = '';
                    logoPreview.style.display = 'none';
                    noPreview.style.display = 'block';
                } catch (error) {
                    console.error('Greška prilikom čuvanja loga:', error);
                    alert('Došlo je do greške prilikom čuvanja loga. Molimo pokušajte sa manjom slikom.');
                }
            } else {
                alert('Molimo vas da postavite logo pre nego što ga sačuvate.');
            }
        });
        
        // Provera validnosti URL-a slike - prihvata sve formate slika, posebno za društvene mreže
        function isValidImageUrl(url) {
            // Provera da li je URL sa društvenih mreža (Facebook, Instagram, Twitter, Imgur, etc.)
            const socialMediaPatterns = [
                /facebook\.com/i,
                /instagram\.com/i,
                /twitter\.com/i,
                /x\.com/i,              // Novi Twitter/X domen
                /imgur\.com/i,
                /pinterest\.com/i,
                /linkedin\.com/i,
                /tumblr\.com/i,
                /flickr\.com/i,
                /cdn\./i,
                /cloudfront\.net/i,
                /cloudinary\.com/i,
                /googleusercontent\.com/i,
                /fbcdn\.net/i,          // Facebook CDN
                /twimg\.com/i,          // Twitter Images
                /cdninstagram\.com/i,   // Instagram CDN
                /pinimg\.com/i,         // Pinterest Images
                /wp\.com/i,             // WordPress
                /staticflickr\.com/i,   // Flickr Static
                /pbs\.twimg\.com/i,     // Twitter (X) images
                /media\.giphy\.com/i,   // Giphy
                /media-cdn\./i,         // Razni CDN-ovi za medije
                /imgflip\.com/i,        // ImgFlip
                /vk\.com/i,             // VKontakte
                /tiktok\.com/i,         // TikTok (za potencijalne avatare)
                /giphy\.com/i           // Giphy linkovi
            ];
            
            // Specifični obrasci za poznate servise za deljenje slika
            const imageHostPatterns = [
                /imgur\.com\/[a-zA-Z0-9]{5,10}(\.[a-zA-Z]{3,4})?$/i,   // Imgur direktni linkovi
                /i\.imgur\.com/i,
                /ibb\.co/i,
                /postimg\.cc/i,
                /imgbb\.com/i,
                /imageshack\.com/i,
                /dropbox\.com.*\?dl=1/i,
                /drive\.google\.com.*\/view/i,
                /drive\.google\.com.*\/uc\?/i,      // Google Drive direktan link
                /onedrive\.live\.com.*\?/i,         // OneDrive linkovi
                /dl\.dropboxusercontent\.com/i,     // Dropbox direktni linkovi
                /media\.discordapp\.net/i,          // Discord media
                /res\.cloudinary\.com/i,            // Cloudinary resursi
                /\.(googleusercontent|ggpht)\.com/i // Google Photo/Drive URL-ovi
            ];
            
            // Specifični obrasci za URL transformacije - neki servisi imaju posebne URL-ove za slike
            if (url.includes('drive.google.com') && url.includes('/file/d/')) {
                // Transformiši Google Drive link u direktan link za pregled
                const fileId = url.match(/\/file\/d\/([^\/]+)/);
                if (fileId && fileId[1]) {
                    console.log('Detektovan Google Drive link, transformisan u direktan link');
                    return true; // Vraćamo true jer ćemo transformisati URL kasnije
                }
            }
            
            // Instagram specific pattern - često zahteva obradu
            if (url.includes('instagram.com/p/')) {
                console.log('Detektovan Instagram post link');
                return true; // Instagram će zahtevati posebnu obradu
            }
            
            // Provera da li URL odgovara nekom od društvenih mreža
            const isSocialMedia = socialMediaPatterns.some(pattern => pattern.test(url));
            
            // Provera da li URL odgovara nekom od direktnih servisa za deljenje slika
            const isImageHost = imageHostPatterns.some(pattern => pattern.test(url));
            
            // Provera da li URL ima ekstenziju slike
            const hasImageExtension = /\.(jpg|jpeg|png|gif|bmp|webp|svg|ico|tiff|avif)(\?.*)?$/i.test(url);
            
            // Provera za direktne linkove do slika koji sadrže ključne reči
            const hasImageKeywords = /(image|photo|slika|picture|avatar|logo|thumbnail|icon|media|cdn)/i.test(url);
            
            // Vraćamo true ako je društvena mreža ili servis za deljenje slika ili ima ekstenziju slike
            return isSocialMedia || isImageHost || hasImageExtension || hasImageKeywords;
        }
        
        // Funkcija za učitavanje upita korisnika
        function loadInquiries() {
            const inquiries = JSON.parse(localStorage.getItem('unansweredQuestions') || '[]');
            const filter = document.getElementById('inquiriesFilter').value;
            const tbody = document.getElementById('inquiriesList');
            
            // Filtriraj upite prema izabranom filteru
            let filteredInquiries = [...inquiries];
            if (filter !== 'all') {
                filteredInquiries = inquiries.filter(inquiry => inquiry.status === filter);
            }
            
            // Sortiraj po datumu (najnovije prvo)
            filteredInquiries.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            // Generiši redove tabele
            tbody.innerHTML = filteredInquiries.length > 0 ? '' : '<tr><td colspan="7" class="text-center">Nema upita za prikaz</td></tr>';
            
            filteredInquiries.forEach(inquiry => {
                const tr = document.createElement('tr');
                tr.dataset.id = inquiry.id;
                tr.innerHTML = `
                    <td>#${inquiry.id.toString().slice(-6)}</td>
                    <td>${new Date(inquiry.timestamp).toLocaleString()}</td>
                    <td>${inquiry.question}</td>
                    <td>${inquiry.email}</td>
                    <td>${inquiry.phone || 'Nije naveden'}</td>
                    <td>
                        <select class="status-select" data-id="${inquiry.id}">
                            <option value="new" ${inquiry.status === 'new' ? 'selected' : ''}>Nov</option>
                            <option value="in_progress" ${inquiry.status === 'in_progress' ? 'selected' : ''}>U obradi</option>
                            <option value="resolved" ${inquiry.status === 'resolved' ? 'selected' : ''}>Rešen</option>
                        </select>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-primary contact-btn" data-email="${inquiry.email}" data-phone="${inquiry.phone}">
                            <i class="fas fa-envelope"></i>
                        </button>
                        <button class="btn btn-sm btn-danger delete-btn" data-id="${inquiry.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
            
            // Dodaj event listenere za promenu statusa
            document.querySelectorAll('.status-select').forEach(select => {
                select.addEventListener('change', function() {
                    const id = parseInt(this.dataset.id);
                    const newStatus = this.value;
                    updateInquiryStatus(id, newStatus);
                });
            });
            
            // Dodaj event listenere za dugmad za kontakt
            document.querySelectorAll('.contact-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const email = this.dataset.email;
                    const phone = this.dataset.phone;
                    let contactInfo = `Email: ${email}`;
                    if (phone && phone !== 'Nije naveden') {
                        contactInfo += `\nTelefon: ${phone}`;
                    }
                    alert(`Kontakt informacije:\n${contactInfo}`);
                });
            });
            
            // Dodaj event listenere za dugmad za brisanje
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (confirm('Da li ste sigurni da želite da obrišete ovaj upit?')) {
                        const id = parseInt(this.dataset.id);
                        deleteInquiry(id);
                    }
                });
            });
        }
        
        // Funkcija za ažuriranje statusa upita
        function updateInquiryStatus(id, newStatus) {
            const inquiries = JSON.parse(localStorage.getItem('unansweredQuestions') || '[]');
            const index = inquiries.findIndex(inq => inq.id === id);
            
            if (index !== -1) {
                inquiries[index].status = newStatus;
                localStorage.setItem('unansweredQuestions', JSON.stringify(inquiries));
                
                // Ažuriraj prikaz
                if (document.querySelector('.tab-content#inquiriesTab').style.display === 'block') {
                    loadInquiries();
                }
            }
        }
          // Funkcija za brisanje upita
        function deleteInquiry(id) {
            let inquiries = JSON.parse(localStorage.getItem('unansweredQuestions') || '[]');
            inquiries = inquiries.filter(inq => inq.id !== id);
            localStorage.setItem('unansweredQuestions', JSON.stringify(inquiries));
            
            // Ažuriraj prikaz
            if (document.querySelector('.tab-content#inquiriesTab').style.display === 'block') {
                loadInquiries();
            }
        }
        
        // ==================== KONSULTACIJE FUNKCIJE ====================
          // Funkcija za ažuriranje statistika konsultacija
        function updateConsultationStats() {
            const consultations = JSON.parse(localStorage.getItem('consultationAppointments') || '[]');
            
            // Računanje brojeva za svaki status
            const pending = consultations.filter(c => c.status === 'pending').length;
            const confirmed = consultations.filter(c => c.status === 'confirmed').length;
            const completed = consultations.filter(c => c.status === 'completed').length;
            const canceled = consultations.filter(c => c.status === 'canceled').length;
            
            // Ažuriranje UI elemenata
            document.getElementById('pendingCount').textContent = pending;
            document.getElementById('confirmedCount').textContent = confirmed;
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('canceledCount').textContent = canceled;
        }
        
        // Funkcija za učitavanje konsultacija u admin panelu
        function loadConsultations() {
            const consultations = JSON.parse(localStorage.getItem('consultationAppointments') || '[]');
            const filter = document.getElementById('consultationsFilter')?.value || 'all';
            const container = document.getElementById('consultationsTable');
            
            if (!container) return;
            
            // Filtriraj konsultacije prema izabranom filteru
            let filteredConsultations = [...consultations];
            if (filter !== 'all') {
                filteredConsultations = consultations.filter(consultation => consultation.status === filter);
            }
            
            // Sortiraj po datumu (najnovije prvo)
            filteredConsultations.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            // Ako nema konsultacija
            if (filteredConsultations.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>Nema zakazanih konsultacija.</p></div>';
                return;
            }
            
            // Prevod statusa na srpski
            const statusTranslation = {
                'pending': 'Na čekanju',
                'confirmed': 'Potvrđeno',
                'canceled': 'Otkazano',
                'completed': 'Završeno'
            };
            
            // Boje za različite statuse
            const statusColors = {
                'pending': '#f59e0b',
                'confirmed': '#10b981',
                'canceled': '#ef4444',
                'completed': '#6366f1'
            };
            
            // Kreiranje tabele
            let tableHtml = `
                <table class="consultations-table">
                    <thead>
                        <tr>
                            <th>Datum zakazivanja</th>
                            <th>Ime i prezime</th>
                            <th>Email</th>
                            <th>Grad/Država</th>
                            <th>Tema</th>
                            <th>Termin</th>
                            <th>Status</th>
                            <th>Akcije</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            filteredConsultations.forEach(consultation => {
                const statusText = statusTranslation[consultation.status] || consultation.status;
                const statusColor = statusColors[consultation.status] || '#64748b';
                
                tableHtml += `
                    <tr data-id="${consultation.id}">
                        <td>${new Date(consultation.createdAt).toLocaleDateString('sr-RS')}</td>
                        <td>${consultation.name}</td>
                        <td><a href="mailto:${consultation.email}" class="email-link">${consultation.email}</a></td>
                        <td>${consultation.location}</td>
                        <td>${consultation.topic}</td>
                        <td>${new Date(consultation.dateTime).toLocaleString('sr-RS')}</td>
                        <td><span class="status-badge" style="background-color: ${statusColor};">${statusText}</span></td>
                        <td>
                            <div class="action-buttons">
                `;
                
                // Dinamički prikaz dugmića u zavisnosti od statusa
                if (consultation.status === 'pending') {
                    tableHtml += `
                                <button class="action-btn confirm-btn" data-id="${consultation.id}" title="Potvrdi">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="action-btn cancel-btn" data-id="${consultation.id}" title="Otkaži">
                                    <i class="fas fa-times"></i>
                                </button>
                    `;
                } else if (consultation.status === 'confirmed') {
                    tableHtml += `
                                <button class="action-btn complete-btn" data-id="${consultation.id}" title="Označi kao završeno">
                                    <i class="fas fa-check-double"></i>
                                </button>
                                <button class="action-btn cancel-btn" data-id="${consultation.id}" title="Otkaži">
                                    <i class="fas fa-times"></i>
                                </button>
                    `;
                }
                
                // Dugme za brisanje je uvek dostupno
                tableHtml += `
                                <button class="action-btn delete-btn" data-id="${consultation.id}" title="Obriši">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            tableHtml += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = tableHtml;
            
            // Dodaj event listenere za dugmiće
            addConsultationActionListeners(container);
        }
        
        // Funkcija za dodavanje event listenera na dugmiće konsultacija
        function addConsultationActionListeners(container) {
            // Listener za potvrdu konsultacije
            container.querySelectorAll('.confirm-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    if (confirm('Da li ste sigurni da želite da potvrdite ovu konsultaciju?')) {
                        updateConsultationStatusLocal(id, 'confirmed');
                        loadConsultations();
                        updateConsultationStats();
                    }
                });
            });
            
            // Listener za otkazivanje konsultacije
            container.querySelectorAll('.cancel-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    if (confirm('Da li ste sigurni da želite da otkažete ovu konsultaciju?')) {
                        updateConsultationStatusLocal(id, 'canceled');
                        loadConsultations();
                        updateConsultationStats();
                    }
                });
            });
            
            // Listener za označavanje konsultacije kao završene
            container.querySelectorAll('.complete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    if (confirm('Da li ste sigurni da želite da označite ovu konsultaciju kao završenu?')) {
                        updateConsultationStatusLocal(id, 'completed');
                        loadConsultations();
                        updateConsultationStats();
                    }
                });
            });
            
            // Listener za brisanje konsultacije
            container.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    if (confirm('Da li ste sigurni da želite da obrišete ovu konsultaciju? Ova akcija se ne može poništiti.')) {
                        deleteConsultationLocal(id);
                        loadConsultations();
                        updateConsultationStats();
                    }
                });
            });
        }
        
        // Funkcija za promenu statusa konsultacije lokalno
        function updateConsultationStatusLocal(id, newStatus) {
            const consultations = JSON.parse(localStorage.getItem('consultationAppointments') || '[]');
            const updatedConsultations = consultations.map(consultation => {
                if (consultation.id === id) {
                    return { ...consultation, status: newStatus, updatedAt: new Date().toISOString() };
                }
                return consultation;
            });
            
            localStorage.setItem('consultationAppointments', JSON.stringify(updatedConsultations));
        }
        
        // Funkcija za brisanje konsultacije lokalno
        function deleteConsultationLocal(id) {
            const consultations = JSON.parse(localStorage.getItem('consultationAppointments') || '[]');
            const updatedConsultations = consultations.filter(consultation => consultation.id !== id);
            
            localStorage.setItem('consultationAppointments', JSON.stringify(updatedConsultations));
        }
        
        // Funkcija za izvoz konsultacija u CSV format
        function exportConsultationsToCSV() {
            const consultations = JSON.parse(localStorage.getItem('consultationAppointments') || '[]');
            
            if (consultations.length === 0) {
                alert('Nema podataka za izvoz.');
                return;
            }
            
            // CSV header
            const headers = [
                'ID',
                'Datum zakazivanja',
                'Ime i prezime',
                'Email',
                'Grad/Država',
                'Tema',
                'Termin',
                'Opis',
                'Status'
            ];
            
            // Kreiranje CSV redova
            const csvRows = [headers.join(',')];
            
            consultations.forEach(consultation => {
                const row = [
                    consultation.id,
                    new Date(consultation.createdAt).toLocaleDateString('sr-RS'),
                    `"${consultation.name}"`,
                    consultation.email,
                    `"${consultation.location}"`,
                    `"${consultation.topic}"`,
                    new Date(consultation.dateTime).toLocaleString('sr-RS'),
                    `"${consultation.description.replace(/"/g, '""')}"`, // Escape quotes
                    consultation.status
                ];
                csvRows.push(row.join(','));
            });
            
            // Kreiranje i preuzimanje fajla
            const csvContent = csvRows.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `konsultacije_${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }
        
        // Inicijalizacija
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            loadSavedLogo();
            loadLocalStorageData();
            
            // Dodaj event listener za dugme za osvežavanje upita
            document.getElementById('refreshInquiriesBtn')?.addEventListener('click', loadInquiries);
            
            // Dodaj event listener za filter upita
            document.getElementById('inquiriesFilter')?.addEventListener('change', loadInquiries);
              // Dodaj event listenere za konsultacije
            document.getElementById('refreshConsultationsBtn')?.addEventListener('click', function() {
                loadConsultations();
                updateConsultationStats();
            });
            
            document.getElementById('consultationsFilter')?.addEventListener('change', function() {
                loadConsultations();
            });
            
            document.getElementById('exportConsultationsBtn')?.addEventListener('click', exportConsultationsToCSV);
              // Inicijalno ažuriranje statistika konsultacija
            updateConsultationStats();
        });
    </script>
    
    <!-- Include consultation script for admin functionality -->
    <script src="js/consultation.js"></script>
</body>
</html>
